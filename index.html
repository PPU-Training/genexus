<!doctype html>
<html x-data="{ darkMode: true }" :class="{ 'dark': darkMode }" lang="en">
    <head>
        <meta charset="utf-8" />
        <meta content="width=device-width, initial-scale=1.0" name="viewport" />
        <title>GeneXus Documentation</title>
        <link href="https://fonts.googleapis.com" rel="preconnect" />
        <link
            crossorigin=""
            href="https://fonts.gstatic.com"
            rel="preconnect"
        />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=Noto+Sans:wght@400;500;700&display=swap"
            rel="stylesheet"
        />

        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/github-markdown-css@5/github-markdown.min.css"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/highlight.js@11/styles/github.min.css"
        />
        <script src="./assets/menu.js"></script>
        <script src="https://unpkg.com/lucide@latest"></script>
        <script
            defer
            src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
        ></script>
        <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
        <script id="tailwind-config">
            tailwind.config = {
                darkMode: "class",
                theme: {
                    extend: {
                        colors: {
                            primary: "#197fe6",
                            "background-light": "#f6f7f8",
                            "background-dark": "#111921",
                            "surface-dark": "#1a242f",
                            "border-dark": "#2a3b4c",
                        },
                        fontFamily: {
                            display: ["Inter", "sans-serif"],
                            body: ["Noto Sans", "sans-serif"],
                        },
                    },
                },
            };
        </script>
        <style>
            .custom-scrollbar::-webkit-scrollbar {
                width: 6px;
            }
            .custom-scrollbar::-webkit-scrollbar-track {
                background: #111921;
            }
            .custom-scrollbar::-webkit-scrollbar-thumb {
                background: #2a3b4c;
                border-radius: 3px;
            }
            .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                background: #197fe6;
            }
            body {
                font-family: "Inter", sans-serif;
            }
            [x-cloak] {
                display: none !important;
            }
            .markdown-body {
                background-color: transparent;
            }
        </style>
    </head>
    <body
        class="select-none bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 flex flex-col h-screen overflow-hidden"
    >
        <header
            class="flex-none flex items-center justify-between whitespace-nowrap border-b border-solid border-slate-200 dark:border-border-dark bg-white dark:bg-[#0d131a] px-6 py-3 z-20"
        >
            <div class="flex items-center gap-4">
                <div
                    class="size-8 text-primary flex items-center justify-center"
                >
                    <svg
                        class="h-8 w-8"
                        fill="none"
                        viewBox="0 0 48 48"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                            d="M4 42.4379C4 42.4379 14.0962 36.0744 24 41.1692C35.0664 46.8624 44 42.2078 44 42.2078L44 7.01134C44 7.01134 35.068 11.6577 24.0031 5.96913C14.0971 0.876274 4 7.27094 4 7.27094L4 42.4379Z"
                            fill="currentColor"
                        ></path>
                    </svg>
                </div>
                <h2
                    class="text-slate-900 dark:text-white text-lg font-bold leading-tight tracking-[-0.015em]"
                >
                    PPU GeneXus Docs
                </h2>
            </div>
            <div class="flex flex-1 justify-end gap-8">
                <div class="hidden md:flex items-center gap-9">
                    <a
                        class="text-slate-600 dark:text-slate-300 hover:text-primary transition-colors text-sm font-medium"
                        href="https://docs.genexus.com/en/genexus"
                        target="_blank"
                        >GeneXus.com</a
                    >
                    <a
                        class="text-slate-600 dark:text-slate-300 hover:text-primary transition-colors text-sm font-medium"
                        href="https://github.com/PPU-Training/genexus/issues"
                        target="_blank"
                        >Community</a
                    >
                    <a
                        class="text-slate-600 dark:text-slate-300 hover:text-primary transition-colors text-sm font-medium"
                        href="https://github.com/PPU-Training/genexus"
                        target="_blank"
                        >GitHub</a
                    >
                </div>
                <div class="flex gap-2">
                    <button
                        @click="darkMode = !darkMode"
                        class="flex items-center justify-center rounded-lg size-10 bg-slate-100 dark:bg-surface-dark text-slate-900 dark:text-white hover:bg-slate-200 dark:hover:bg-border-dark transition-colors"
                    >
                        <i
                            x-show="!darkMode"
                            data-lucide="moon"
                            class="size-5"
                        ></i>
                        <i
                            x-show="darkMode"
                            data-lucide="sun"
                            class="size-5"
                            x-cloak
                        ></i>
                    </button>
                </div>
            </div>
        </header>
        <div class="flex flex-1 overflow-hidden relative">
            <aside
                class="hidden lg:flex flex-col w-72 border-r border-slate-200 dark:border-border-dark bg-slate-50 dark:bg-[#0f151c] flex-none z-10"
            >
                <div
                    x-data="menuSearch()"
                    class="p-4 border-b relative border-slate-200 dark:border-border-dark sticky top-0 bg-slate-50 dark:bg-[#0f151c] z-10"
                >
                    <label class="flex flex-col w-full h-10">
                        <div
                            class="flex w-full flex-1 items-stretch rounded-lg h-full bg-white dark:bg-surface-dark border border-slate-200 dark:border-border-dark focus-within:ring-2 focus-within:ring-primary"
                        >
                            <div
                                class="text-slate-400 flex items-center justify-center pl-3"
                            >
                                <i data-lucide="search" class="size-4"></i>
                            </div>
                            <input
                                x-model="query"
                                @input="search()"
                                @focus="open = true"
                                @click.away="open = false"
                                class="flex w-full min-w-0 flex-1 bg-transparent border-none text-sm text-slate-900 dark:text-white focus:ring-0 placeholder:text-slate-400 px-2"
                                placeholder="Search..."
                            />
                        </div>
                    </label>
                    <div
                        x-show="open && query.length > 0"
                        x-cloak
                        class="absolute left-4 right-4 mt-1 bg-white dark:bg-surface-dark border border-slate-200 dark:border-border-dark rounded-lg shadow-lg max-h-64 overflow-y-auto z-50"
                    >
                        <template x-if="results.length === 0">
                            <div class="px-4 py-2 text-sm text-slate-400">
                                No results found
                            </div>
                        </template>
                        <template x-for="item in results" :key="item.file">
                            <a
                                @click="loadContent(item.file)"
                                class="flex flex-col px-4 py-2 hover:bg-slate-100 dark:hover:bg-border-dark text-sm cursor-pointer"
                            >
                                <span
                                    class="text-slate-900 dark:text-white"
                                    x-text="item.name"
                                ></span>
                                <span
                                    class="text-xs text-slate-400"
                                    x-text="item.group"
                                ></span>
                            </a>
                        </template>
                    </div>
                </div>
                <nav
                    x-data
                    x-icons
                    class="flex-1 overflow-y-auto p-4 flex flex-col gap-1 custom-scrollbar"
                >
                    <div class="mb-4">
                        <a
                            @click="loadContent('/docs/main-menu/home.md')"
                            class="flex items-center gap-3 px-3 py-2 rounded-lg bg-primary/10 text-primary font-medium text-sm cursor-pointer"
                        >
                            <i data-lucide="home" class="size-5"></i>Home</a
                        >
                        <a
                            @click="loadContent('/docs/main-menu/new.md')"
                            class="flex items-center gap-3 px-3 py-2 mt-2 rounded-lg hover:bg-slate-200 dark:hover:bg-surface-dark text-slate-600 dark:text-slate-400 text-sm font-medium cursor-pointer"
                        >
                            <i data-lucide="zap" class="size-5"></i>What's
                            New</a
                        >
                    </div>
                    <div
                        class="text-xs font-bold text-slate-500 uppercase tracking-wider px-3 mb-2 mt-2"
                    >
                        Documentation
                    </div>
                    <template
                        x-for="group in window.menuData"
                        :key="group.title"
                    >
                        <details class="group" :open="group.open ?? false">
                            <summary
                                class="flex cursor-pointer items-center justify-between px-3 py-2 rounded-lg hover:bg-slate-200 dark:hover:bg-surface-dark text-slate-700 dark:text-slate-300"
                            >
                                <span
                                    class="text-sm font-medium"
                                    x-text="group.title"
                                ></span>
                                <i
                                    data-lucide="chevron-down"
                                    class="size-4 transform transition-transform group-open:rotate-180"
                                ></i>
                            </summary>
                            <div
                                class="pl-4 pr-2 pt-1 pb-2 flex flex-col gap-0.5 border-l border-slate-200 dark:border-border-dark ml-4 mt-1"
                            >
                                <template
                                    x-for="item in group.submenus"
                                    :key="item.name"
                                >
                                    <a
                                        @click="loadContent(item.file)"
                                        class="block px-3 py-1.5 rounded hover:bg-slate-200 dark:hover:bg-surface-dark text-sm text-slate-600 dark:text-slate-400 hover:text-primary cursor-pointer"
                                        x-text="item.name"
                                    ></a>
                                </template>
                            </div>
                        </details>
                    </template>
                </nav>
                <div
                    class="p-4 border-t border-slate-200 dark:border-border-dark"
                >
                    <a
                        @click="loadContent('/docs/feedback.md')"
                        class="flex items-center gap-3 text-xs text-slate-500 hover:text-primary transition-colors cursor-pointer"
                    >
                        <i data-lucide="message-square" class="size-4"></i
                        >Provide Feedback</a
                    >
                </div>
            </aside>
            <main
                class="flex-1 overflow-y-auto bg-background-light dark:bg-background-dark scroll-smooth"
            >
                <div
                    id="content"
                    class="markdown-body text-slate-700 dark:text-white w-full max-w-6xl mx-auto p-8"
                >
                    <div class="text-center py-20 text-slate-400">
                        <i
                            data-lucide="file-text"
                            class="size-16 mx-auto mb-4 opacity-50"
                        ></i>
                        <p class="text-lg">
                            Select a document from the sidebar to view content
                        </p>
                    </div>
                </div>
            </main>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script>
            document.addEventListener("alpine:init", () => {
                Alpine.directive("icons", (el) => {
                    Alpine.effect(() => {
                        requestAnimationFrame(() => {
                            lucide.createIcons();
                        });
                    });
                });
            });

            function menuSearch() {
                return {
                    query: "",
                    open: false,
                    results: [],
                    search() {
                        if (this.query.trim() === "") {
                            this.results = [];
                            return;
                        }
                        const q = this.query.toLowerCase();
                        this.results = window.menuData
                            .flatMap((group) =>
                                group.submenus.map((item) => ({
                                    ...item,
                                    group: group.title,
                                })),
                            )
                            .filter((item) =>
                                item.name.toLowerCase().includes(q),
                            )
                            .slice(0, 10);
                    },
                };
            }

            function loadContent(filePath) {
                const baseUrl = "https://ppu-training.github.io/genexus";
                const fullUrl = filePath.startsWith("http")
                    ? filePath
                    : baseUrl + filePath;

                const contentDiv = document.getElementById("content");
                contentDiv.innerHTML = `
                    <div class="flex items-center justify-center min-h-[400px]">
                        <div class="text-center">
                            <i data-lucide="loader" class="size-12 mx-auto mb-4 text-primary animate-spin"></i>
                            <p class="text-slate-600 dark:text-slate-400">Loading content...</p>
                        </div>
                    </div>
                `;

                lucide.createIcons();

                fetch(fullUrl)
                    .then((res) => {
                        if (!res.ok) throw new Error("Failed to load content");
                        return res.text();
                    })
                    .then((md) => {
                        marked.setOptions({
                            highlight: function (code, lang) {
                                if (window.hljs && lang) {
                                    try {
                                        return window.hljs.highlight(code, {
                                            language: lang,
                                        }).value;
                                    } catch (e) {
                                        return window.hljs.highlightAuto(code)
                                            .value;
                                    }
                                }
                                return code;
                            },
                        });

                        const html = marked.parse(md);
                        contentDiv.innerHTML = `
                            <div class="prose dark:prose-invert max-w-none">
                                ${html}
                            </div>
                        `;

                        if (window.hljs) {
                            document
                                .querySelectorAll("pre code")
                                .forEach((block) => {
                                    window.hljs.highlightElement(block);
                                });
                        }

                        lucide.createIcons();

                        history.pushState(
                            {},
                            "",
                            `?file=${encodeURIComponent(filePath)}`,
                        );
                    })
                    .catch((err) => {
                        contentDiv.innerHTML = `
                            <div class="text-center py-20">
                                <i data-lucide="alert-circle" class="size-16 mx-auto mb-4 text-red-500"></i>
                                <h2 class="text-2xl font-bold mb-2">Error</h2>
                                <p class="text-slate-600 dark:text-slate-400">${err.message}</p>
                                <button @click="loadContent('${filePath}')" class="mt-4 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors">
                                    Try Again
                                </button>
                            </div>
                        `;
                        lucide.createIcons();
                    });
            }

            window.loadContent = loadContent;

            document.addEventListener("DOMContentLoaded", () => {
                const params = new URLSearchParams(window.location.search);
                const fileParam = params.get("file");

                if (fileParam) {
                    loadContent(fileParam);
                } else {
                    loadContent("/docs/main-menu/home.md");
                }

                lucide.createIcons();
            });

            window.addEventListener("popstate", () => {
                const params = new URLSearchParams(window.location.search);
                const fileParam = params.get("file");

                if (fileParam) {
                    loadContent(fileParam);
                } else {
                    loadContent("/docs/main-menu/home.md");
                }
            });
        </script>
    </body>
</html>
